#!/usr/bin/python3
import socket
import os

server = socket.socket()
server.bind(('172.31.8.131', 9999))
server.listen(1)
print("server open!")
client, addr = server.accept()

filename = 'result.log'
data_transferred = 0
data = client.recv(1024)
with open("/home/centos/data/server/result"+"/"+filename, 'wb') as f: #현재dir에 filename으로 파일을 받는다
    try:
        while data: #데이터가 있을 때까지
            f.write(data) #1024바이트 쓴다
            data_transferred += len(data)
            data = client.recv(1024) #1024바이트를 받아 온다
    except Exception as ex:
        print(ex)
print('파일 %s 받기 완료. 전송량 %d' %(filename, data_transferred))

client.close()
server.close()